<style>
  <% case Random.rand(4) %>
    <% when 0 %>
      paper-tabs#paper_tabs::shadow #selectionBar {
        background-color: #18ffff;
      }
      #paper_tabs paper-tab::shadow #ink {
        color: #18ffff;
      }
    <% when 1 %>
      paper-tabs#paper_tabs::shadow #selectionBar {
        background-color: #ff4081;
      }
      #paper_tabs paper-tab::shadow #ink {
        color: #ff4081;
      }
    <% when 2 %>
      paper-tabs#paper_tabs::shadow #selectionBar {
        background-color: #eeff41;
      }
      #paper_tabs paper-tab::shadow #ink {
        color: #eeff41;
      }
    <% when 3 %>
      paper-tabs#paper_tabs::shadow #selectionBar {
        background-color: #536dfe;
      }
      #paper_tabs paper-tab::shadow #ink {
        color: #536dfe;
      }
  <% end %>
</style>

<% content_for :title, "While True" %>

<% if notice %>
  <paper-toast id="toast1" class="capsule" text="<%= notice %>" style="padding-right: 60px;" duration="10000" opened responsiveWidth="300px"></paper-toast>
<% end %>

<core-animated-pages id="baluga2" selected="0" transitions="cross-fade cross-fade-delayed slide-down tile-cascade hero-transition">

  <section id="page1">
    <%= image_tag "penrose_icon.png", id: "logo_main", "layout" => "", "horizontal" => "", "center-justified" => "", "cross-fade" => "" %>
    <p id="connecting" layout horizontal center-justified cross-fade>Connecting...</p>
    <div class="loader" cross-fade>Loading...</div>
  </section>  

  <section id="page2" style="display:none;">
<core-overlay id="overlay" backdrop transition="core-transition-center" style="background:#f5f5f5;box-sizing: border-box;-moz-box-sizing: border-box;webkit-user-select: none;-moz-user-select: none;padding:20px 20px;outline: 1px solid rgba(0,0,0,0.2);box-shadow: 0 4px 16px rgba(0,0,0,0.2);">
  <div id="contentsd">
    <div end-justified layout horizontal>
      <paper-icon-button icon="clear" size="27" core-overlay-toggle></paper-icon-button>
    </div>
    
    <section id="section" layout vertical>
      <paper-tabs id="paper_tabs">
        <paper-tab id="paper_tab">LOGIN</paper-tab>
        <paper-tab id="paper_tab1">SIGN UP</paper-tab>
      </paper-tabs>
     
      <section id="section1" flex relative>
        <core-animated-pages id="baluga" transitions="slide-from-right">
          <section id="section2">
            <%= render "sessions/login", :@user => User.new %>
            <div id="forgot_password" layout flex horizontal center-justified>Forget?</div>
            <%= render "forgot" %>
          </section>
          
          <section id="section3">
            <%= render "users/form" %>
          </section>
        </core-animated-pages>
      </section>
    </section>
  </div>
</core-overlay>

<%= button_to 'Logout', logout_path, { :id => "logout_button_invis", method: :delete, remote: true, style: "display:none;" } %>

<core-overlay id="overlay2" backdrop transition="core-transition-center" style="background:#f5f5f5;box-sizing: border-box;-moz-box-sizing: border-box;webkit-user-select: none;-moz-user-select: none;overflow: hidden;padding:20px 20px;outline: 1px solid rgba(0,0,0,0.2);box-shadow: 0 4px 16px rgba(0,0,0,0.2);">
  <div id="contentsdf">
    <div end-justified layout horizontal>
      <paper-icon-button icon="clear" size="27" core-overlay-toggle></paper-icon-button>
    </div>
  	<div id="user_overlay">
  		<% if (@user = User.find_by_id(session[:user_id])) != nil %>
  	   	<%= render "users/show", :@user =>  User.find_by_id(session[:user_id])%>
  	  <% end %>
    </div>
  </div>
</core-overlay>

<div id="new_post_button_container">
  <% if User.find_by_id(session[:user_id]) != nil %>
    <% if User.find_by_id(session[:user_id]).administrator %>
      <paper-fab icon="add" id="new_post_button" cross-fade-delayed></paper-fab>
    <% end %>
  <% end %>
</div>


    <div id="new_container">
      <core-toolbar id="main_toolbar" class="tall" slide-down>
        <span id="whose_logged_in" layout horizontal flex end-justified cross-fade-delayed>
          <% if (@user = User.find_by_id(session[:user_id])) != nil %>
            <div id="post_avatar" style="background-image: url('<%= User.find_by_id(session[:user_id]).image_url(:avatar) %>');"></div>
            <div id="usernames" layout vertical center-justified><%= User.find_by_id(session[:user_id]).username %></div>
            <paper-button id="logout_button">Logout</paper-button>
          <%else%>
            <% if User.find_by_id(session[:user_id]) == nil %>
              <paper-button id="login_button">Login</paper-button>
                <span layout vertical center-justified>/</span> 
              <paper-button id="signup_button">signup</paper-button>
            <% end %>
          <% end %>
        </span>
      </core-toolbar>



      <div id="tile_container" tile-cascade>
        <%= render @posts %>
        <%= @number_of_posts %>
      </div>
    

      <div id="posts_pagination" style="display:none;">
        <%= will_paginate @posts, page_links: false%>
      </div>

      <div id="about" style="display:none;">
        <%= render 'about' %>
      </div>
    </div>
  </section>
  
  <section id="page3">
    <div id="actual_post_info" >
    </div>
  </section>
</core-animated-pages>


<script>
  $(window).resize(function() {
      $("#posts_pagination").css("display", "none");
      $("#about").css("display", "none");
      setTimeout(function() {
        $("#posts_pagination").css("display", "none");
        $("#about").css("display", "none");
        var docHeight = ((document.getElementById("new_container").scrollHeight) +10) + "px"; 
        $('#posts_pagination').css("top", docHeight);
        $("#posts_pagination").css("display", "block");
        var docHeight = ((document.getElementById("new_container").scrollHeight) +10) + "px"; 
        $('#about').css("top", docHeight);
        $("#about").css("display", "block");
      }, 500);
  });

  $('.post').on('click', function() {
    var el = document.getElementById(this.id);
    el.getElementsByTagName('a')[0].click();
    $('#'+this.id).find('.tint_layer').attr("cross-fade", "");
    $('#'+this.id).find('#home_post_title').attr("cross-fade-delayed", "");
    $('#'+this.id).find('#home_post_author').attr("cross-fade-delayed", "");
    // document.pushState();
  });

  $('.ajax_button_check').on('ajax:complete', function() {
    setTimeout(function() {
      document.getElementById('baluga2').selected=2;
    }, 300);
  });

$(window).load(function() {
  setTimeout(function() {
    $("#page2").css("display", "block");
    var el =document.getElementById('baluga2');
    el.selected =1;
    setTimeout(function() {
      $('#tile_container').removeAttr("tile-cascade", "");
      $('#whose_logged_in').removeAttr("cross-fade-delayed", "");
      $('#main_toolbar').removeAttr("slide-down", "");
      var docHeight = ((document.getElementById("new_container").scrollHeight) +10) + "px"; 
      $('#posts_pagination').css("top", docHeight);
      $("#posts_pagination").css("display", "block");
      var docHeight = ((document.getElementById("new_container").scrollHeight) +10) + "px"; 
      $('#about').css("top", docHeight);
      $("#about").css("display", "block");
    }, 2000);
   }, 2000);
});
</script>